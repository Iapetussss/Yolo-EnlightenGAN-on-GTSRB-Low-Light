# ğŸ“ è¶…çº§è¯¦ç»†çš„æ–°æ‰‹æ•™ç¨‹

**è¿™æ˜¯ä¸€ä»½ä¸ºåˆå­¦è€…å‡†å¤‡çš„ã€ä¸€æ­¥ä¸€æ­¥çš„è¯¦ç»†æ•™ç¨‹ã€‚** 
**ä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä¼šæŠŠæ¯ä¸ªç»†èŠ‚éƒ½è§£é‡Šæ¸…æ¥šï¼**

---

## ğŸ“– ç›®å½•

1. [ç¬¬ä¸€æ­¥ï¼šç†è§£é¡¹ç›®ç»“æ„](#ç¬¬ä¸€æ­¥ç†è§£é¡¹ç›®ç»“æ„)
2. [ç¬¬äºŒæ­¥ï¼šç¯å¢ƒå‡†å¤‡](#ç¬¬äºŒæ­¥ç¯å¢ƒå‡†å¤‡)
3. [ç¬¬ä¸‰æ­¥ï¼šä¸‹è½½æ•°æ®é›†](#ç¬¬ä¸‰æ­¥ä¸‹è½½æ•°æ®é›†)
4. [ç¬¬å››æ­¥ï¼šæ•°æ®é¢„å¤„ç†](#ç¬¬å››æ­¥æ•°æ®é¢„å¤„ç†)
5. [ç¬¬äº”æ­¥ï¼šåˆ›å»ºä½å…‰ç…§æ•°æ®](#ç¬¬äº”æ­¥åˆ›å»ºä½å…‰ç…§æ•°æ®)
6. [ç¬¬å…­æ­¥ï¼šå›¾åƒå¢å¼º](#ç¬¬å…­æ­¥å›¾åƒå¢å¼º)
7. [ç¬¬ä¸ƒæ­¥ï¼šè®­ç»ƒæ¨¡å‹](#ç¬¬ä¸ƒæ­¥è®­ç»ƒæ¨¡å‹)
8. [ç¬¬å…«æ­¥ï¼šæµ‹è¯•å’Œè¯„ä¼°](#ç¬¬å…«æ­¥æµ‹è¯•å’Œè¯„ä¼°)
9. [å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ](#å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ)

---

## ç¬¬ä¸€æ­¥ï¼šç†è§£é¡¹ç›®ç»“æ„

### ä»€ä¹ˆæ˜¯è¿™ä¸ªé¡¹ç›®ï¼Ÿ

è¿™ä¸ªé¡¹ç›®è¦åšçš„äº‹æƒ…å¾ˆç®€å•ï¼š
1. **è¾“å…¥**ï¼šä¸€å¼ ä½å…‰ç…§ï¼ˆå¾ˆæš—ï¼‰çš„äº¤é€šæ ‡å¿—å›¾ç‰‡
2. **å¤„ç†**ï¼š
   - å…ˆç”¨ EnlightenGAN æŠŠå›¾ç‰‡å˜äº®
   - å†ç”¨ YOLOv8 æ£€æµ‹äº¤é€šæ ‡å¿—åœ¨å“ªé‡Œ
3. **è¾“å‡º**ï¼šæ ‡æ³¨äº†äº¤é€šæ ‡å¿—ä½ç½®å’Œç±»åˆ«çš„å›¾ç‰‡

### ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆå¤šæ–‡ä»¶ï¼Ÿ

- `data_preparation.py` - æŠŠåŸå§‹æ•°æ®æ•´ç†æˆç¨‹åºèƒ½ç”¨çš„æ ¼å¼
- `enlightengan_inference.py` - è´Ÿè´£æŠŠæš—çš„å›¾ç‰‡å˜äº®
- `enlightened_gtsrb.py` - ä¸»ç¨‹åºï¼Œè´Ÿè´£è®­ç»ƒå’Œæµ‹è¯•
- `requirements.txt` - åˆ—å‡ºéœ€è¦å®‰è£…çš„å·¥å…·åŒ…
- `traffic_signs.yaml` - å‘Šè¯‰ç¨‹åºæ•°æ®åœ¨å“ªé‡Œã€æœ‰å¤šå°‘ç±»åˆ«

---

## ç¬¬äºŒæ­¥ï¼šç¯å¢ƒå‡†å¤‡

### 2.1 æ£€æŸ¥ Python ç‰ˆæœ¬

æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼ˆCMDï¼‰æˆ– PowerShellï¼Œè¾“å…¥ï¼š

```bash
python --version
```

**æœŸæœ›è¾“å‡º**ï¼š`Python 3.8.x` æˆ–æ›´é«˜ç‰ˆæœ¬

å¦‚æœç‰ˆæœ¬å¤ªä½æˆ–æ²¡æœ‰ Pythonï¼Œè¯·ä» [python.org](https://www.python.org/) ä¸‹è½½å®‰è£…ã€‚

### 2.2 å®‰è£…ä¾èµ–åŒ…

åœ¨å‘½ä»¤æç¤ºç¬¦ä¸­ï¼Œè¿›å…¥é¡¹ç›®ç›®å½•ï¼š

```bash
cd d:\rgznzuoye\new
```

ç„¶åå®‰è£…æ‰€æœ‰éœ€è¦çš„åŒ…ï¼š

```bash
pip install -r requirements.txt
```

**è¿™ä¸€æ­¥ä¼šèŠ±ä¸€äº›æ—¶é—´**ï¼Œå› ä¸ºè¦ä¸‹è½½å¾ˆå¤šåŒ…ã€‚

**å¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼š**
- å¦‚æœæç¤º `pip ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤`ï¼Œè¯´æ˜ Python æ²¡æœ‰æ­£ç¡®å®‰è£…
- å¦‚æœä¸‹è½½å¾ˆæ…¢ï¼Œå¯ä»¥ä½¿ç”¨å›½å†…é•œåƒï¼š
  ```bash
  pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
  ```

### 2.3 æ£€æŸ¥æ˜¯å¦æœ‰ GPU

åœ¨ Python ä¸­è¿è¡Œï¼š

```python
import torch
print(torch.cuda.is_available())  # å¦‚æœè¾“å‡º Trueï¼Œè¯´æ˜æœ‰ GPU
```

**å¦‚æœæ²¡æœ‰ GPU ä¹Ÿæ²¡å…³ç³»**ï¼Œåªæ˜¯è®­ç»ƒä¼šæ…¢ä¸€äº›ã€‚

---

## ç¬¬ä¸‰æ­¥ï¼šä¸‹è½½æ•°æ®é›†

### 3.1 ä¸‹è½½ GTSRB æ•°æ®é›†

**æ–¹æ³• 1ï¼šä» Kaggle ä¸‹è½½ï¼ˆæ¨èï¼‰**

1. è®¿é—®ï¼šhttps://www.kaggle.com/datasets/meowmeowmeowmeowmeow/gtsrb-german-traffic-sign
2. ç‚¹å‡» "Download" æŒ‰é’®
3. ä¸‹è½½å®Œæˆåè§£å‹åˆ°ä¸€ä¸ªç›®å½•ï¼Œä¾‹å¦‚ï¼š`D:\datasets\GTSRB`

**æ–¹æ³• 2ï¼šä»å®˜æ–¹ç½‘ç«™ä¸‹è½½**

1. è®¿é—®ï¼šhttps://benchmark.ini.rub.de/gtsrb_dataset.html
2. ä¸‹è½½è®­ç»ƒé›†å’Œæµ‹è¯•é›†

### 3.2 ç¡®è®¤æ•°æ®é›†ç»“æ„

è§£å‹åï¼Œä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„ç»“æ„ï¼š

```
D:\datasets\GTSRB\
â”œâ”€â”€ Final_Training\
â”‚   â””â”€â”€ Images\
â”‚       â”œâ”€â”€ 00000\           # ç¬¬ 0 ç±»äº¤é€šæ ‡å¿—
â”‚       â”‚   â”œâ”€â”€ 00000_00000.ppm
â”‚       â”‚   â”œâ”€â”€ 00000_00001.ppm
â”‚       â”‚   â””â”€â”€ GT-00000.csv  # æ ‡æ³¨æ–‡ä»¶
â”‚       â”œâ”€â”€ 00001\           # ç¬¬ 1 ç±»äº¤é€šæ ‡å¿—
â”‚       â””â”€â”€ ...
â””â”€â”€ Final_Test\
    â””â”€â”€ Images\
        â”œâ”€â”€ 00000.ppm
        â”œâ”€â”€ 00001.ppm
        â””â”€â”€ GT-final_test.csv  # æµ‹è¯•é›†æ ‡æ³¨
```

**å¦‚æœç»“æ„ä¸ä¸€æ ·ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´åç»­çš„è·¯å¾„ï¼**

---

## ç¬¬å››æ­¥ï¼šæ•°æ®é¢„å¤„ç†

### 4.1 ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®é¢„å¤„ç†ï¼Ÿ

GTSRB æ•°æ®é›†çš„æ ¼å¼æ˜¯ï¼š
- å›¾ç‰‡æ ¼å¼ï¼šPPMï¼ˆä¸€ç§æ¯”è¾ƒè€çš„å›¾ç‰‡æ ¼å¼ï¼‰
- æ ‡æ³¨æ ¼å¼ï¼šCSV æ–‡ä»¶ï¼ŒåŒ…å«è¾¹ç•Œæ¡†åæ ‡

ä½† YOLOv8 éœ€è¦çš„æ ¼å¼æ˜¯ï¼š
- å›¾ç‰‡æ ¼å¼ï¼šPNG æˆ– JPG
- æ ‡æ³¨æ ¼å¼ï¼šæ¯å¼ å›¾ç‰‡ä¸€ä¸ª TXT æ–‡ä»¶ï¼Œæ ¼å¼ä¸º `ç±»åˆ« ä¸­å¿ƒx ä¸­å¿ƒy å®½åº¦ é«˜åº¦`

æ‰€ä»¥æˆ‘ä»¬éœ€è¦è½¬æ¢ï¼

### 4.2 ä¿®æ”¹ data_preparation.py ä¸­çš„è·¯å¾„

æ‰“å¼€ `data_preparation.py`ï¼Œæ‰¾åˆ°æœ€ä¸‹é¢çš„ `if __name__ == "__main__":` éƒ¨åˆ†ï¼š

```python
# ä¿®æ”¹è¿™ä¸¤è¡Œï¼
GTSRB_ROOT = "D:/datasets/GTSRB"  # æ”¹æˆä½ çš„ GTSRB æ•°æ®é›†è·¯å¾„
OUTPUT_ROOT = "../traffic_sign_data/original"  # è¾“å‡ºè·¯å¾„
```

### 4.3 è¿è¡Œè½¬æ¢è„šæœ¬

åœ¨å‘½ä»¤æç¤ºç¬¦ä¸­è¿è¡Œï¼š

```bash
python data_preparation.py
```

**è¿™ä¸€æ­¥ä¼šåšä»€ä¹ˆï¼Ÿ**
1. è¯»å– GTSRB çš„ CSV æ ‡æ³¨æ–‡ä»¶
2. æŠŠæ¯å¼ å›¾ç‰‡çš„ PPM æ ¼å¼è½¬æ¢ä¸º PNG
3. æŠŠè¾¹ç•Œæ¡†åæ ‡è½¬æ¢ä¸º YOLO æ ¼å¼
4. æŠŠè®­ç»ƒé›†åˆ†å‰²æˆè®­ç»ƒé›†å’ŒéªŒè¯é›†ï¼ˆ80%è®­ç»ƒï¼Œ20%éªŒè¯ï¼‰
5. å¤„ç†æµ‹è¯•é›†

**è¿è¡Œå®Œæˆå**ï¼Œä½ ä¼šåœ¨ `d:\rgznzuoye\traffic_sign_data\original\` çœ‹åˆ°ï¼š

```
traffic_sign_data/
â””â”€â”€ original/
    â”œâ”€â”€ images/
    â”‚   â”œâ”€â”€ train/     # è®­ç»ƒå›¾ç‰‡
    â”‚   â”œâ”€â”€ val/       # éªŒè¯å›¾ç‰‡
    â”‚   â””â”€â”€ test/      # æµ‹è¯•å›¾ç‰‡
    â””â”€â”€ labels/
        â”œâ”€â”€ train/     # è®­ç»ƒæ ‡æ³¨
        â”œâ”€â”€ val/       # éªŒè¯æ ‡æ³¨
        â””â”€â”€ test/      # æµ‹è¯•æ ‡æ³¨
```

### 4.4 æ£€æŸ¥è½¬æ¢æ˜¯å¦æˆåŠŸ

è¿è¡Œå®Œåï¼Œè„šæœ¬ä¼šæ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ï¼š

```
=== æ•°æ®é›†ç»Ÿè®¡ ===
Train: 31367 å¼ å›¾åƒ, 31367 ä¸ªæ ‡æ³¨æ–‡ä»¶
Val  : 7842 å¼ å›¾åƒ, 7842 ä¸ªæ ‡æ³¨æ–‡ä»¶
Test : 12630 å¼ å›¾åƒ, 12630 ä¸ªæ ‡æ³¨æ–‡ä»¶
```

**æ•°å­—åº”è¯¥æ˜¯ç±»ä¼¼çš„ï¼ˆå¯èƒ½æœ‰å°çš„å·®å¼‚ï¼‰**ã€‚

---

## ç¬¬äº”æ­¥ï¼šåˆ›å»ºä½å…‰ç…§æ•°æ®

### 5.1 ä¸ºä»€ä¹ˆè¦åˆ›å»ºä½å…‰ç…§æ•°æ®ï¼Ÿ

GTSRB åŸå§‹æ•°æ®é›†çš„å›¾ç‰‡éƒ½æ˜¯æ­£å¸¸å…‰ç…§çš„ã€‚ä½†æˆ‘ä»¬è¦ç ”ç©¶çš„æ˜¯**ä½å…‰ç…§**ç¯å¢ƒä¸‹çš„æ£€æµ‹ï¼Œæ‰€ä»¥éœ€è¦äººå·¥åˆ›å»ºä¸€äº›æš—çš„å›¾ç‰‡ã€‚

### 5.2 ä½å…‰ç…§æ˜¯æ€ä¹ˆåˆ›å»ºçš„ï¼Ÿ

é€šè¿‡è°ƒæ•´ **Gamma å€¼**ã€‚Gamma å€¼ï¼š
- = 1.0ï¼šä¸å˜
- < 1.0ï¼šå˜æš—ï¼ˆä¾‹å¦‚ 0.5 ä¼šè®©å›¾ç‰‡å˜å¾ˆæš—ï¼‰
- > 1.0ï¼šå˜äº®

### 5.3 è¿è¡Œä½å…‰ç…§åˆ›å»ºï¼ˆå·²åŒ…å«åœ¨ data_preparation.py ä¸­ï¼‰

`data_preparation.py` çš„æœ€åå·²ç»åŒ…å«äº†åˆ›å»ºä½å…‰ç…§æ•°æ®çš„ä»£ç ã€‚

å¦‚æœä½ ä¹‹å‰è¿è¡Œäº† `python data_preparation.py`ï¼Œåº”è¯¥å·²ç»åˆ›å»ºäº†ã€‚

æ£€æŸ¥æ˜¯å¦å­˜åœ¨ï¼š`d:\rgznzuoye\traffic_sign_data\low_light\`

å¦‚æœä¸å­˜åœ¨ï¼Œé‡æ–°è¿è¡Œï¼š

```bash
python data_preparation.py
```

---

## ç¬¬å…­æ­¥ï¼šå›¾åƒå¢å¼º

### 6.1 ä¸ºä»€ä¹ˆè¦å¢å¼ºå›¾åƒï¼Ÿ

æˆ‘ä»¬åˆ›å»ºäº†ä½å…‰ç…§å›¾åƒï¼Œä½†è¿™äº›å›¾åƒå¤ªæš—äº†ï¼Œå¾ˆéš¾æ£€æµ‹åˆ°äº¤é€šæ ‡å¿—ã€‚

æ‰€ä»¥æˆ‘ä»¬è¦ç”¨ **EnlightenGAN** æˆ– **ä¼ ç»Ÿæ–¹æ³•** æŠŠå®ƒä»¬å˜äº®ã€‚

### 6.2 æ–¹æ³•é€‰æ‹©

**æ–¹æ³• 1ï¼šEnlightenGANï¼ˆæ•ˆæœæ›´å¥½ï¼Œä½†éœ€è¦ä¸‹è½½æ¨¡å‹ï¼‰**
- éœ€è¦ä¸‹è½½é¢„è®­ç»ƒæ¨¡å‹
- æ¨ç†é€Ÿåº¦è¾ƒå¿«
- æ•ˆæœæœ€å¥½

**æ–¹æ³• 2ï¼šä¼ ç»Ÿæ–¹æ³•ï¼ˆç®€å•ï¼Œä¸éœ€è¦ä¸‹è½½ï¼‰**
- ä½¿ç”¨ CLAHE + Gamma æ ¡æ­£
- ä¸éœ€è¦é¢å¤–ä¸‹è½½
- æ•ˆæœä¹Ÿä¸é”™ï¼ˆæ¨èåˆå­¦è€…ä½¿ç”¨ï¼‰

### 6.3 ä½¿ç”¨ä¼ ç»Ÿæ–¹æ³•å¢å¼ºï¼ˆæ¨èï¼‰

åˆ›å»ºä¸€ä¸ªæ–°è„šæœ¬ `enhance_images.py`ï¼š

```python
from enlightened_gtsrb import GTSRBEnlightenGANDetector

# åˆ›å»ºæ£€æµ‹å™¨
detector = GTSRBEnlightenGANDetector()

# å¢å¼ºè®­ç»ƒé›†
print("å¢å¼ºè®­ç»ƒé›†...")
detector.enhance_dataset(
    input_dir='../traffic_sign_data/low_light/images/train',
    output_dir='../traffic_sign_data/enhanced_images/train',
    method='traditional'
)

# å¢å¼ºéªŒè¯é›†
print("å¢å¼ºéªŒè¯é›†...")
detector.enhance_dataset(
    input_dir='../traffic_sign_data/low_light/images/val',
    output_dir='../traffic_sign_data/enhanced_images/val',
    method='traditional'
)

# å¢å¼ºæµ‹è¯•é›†
print("å¢å¼ºæµ‹è¯•é›†...")
detector.enhance_dataset(
    input_dir='../traffic_sign_data/low_light/images/test',
    output_dir='../traffic_sign_data/enhanced_images/test',
    method='traditional'
)

print("å¢å¼ºå®Œæˆï¼")
```

ç„¶åè¿è¡Œï¼š

```bash
python enhance_images.py
```

**è¿™ä¸€æ­¥ä¼šèŠ±æ¯”è¾ƒé•¿çš„æ—¶é—´**ï¼Œå› ä¸ºè¦å¤„ç†å‡ ä¸‡å¼ å›¾ç‰‡ã€‚

### 6.4 å¤åˆ¶æ ‡æ³¨æ–‡ä»¶

å¢å¼ºå›¾åƒåï¼Œè¿˜éœ€è¦å¤åˆ¶æ ‡æ³¨æ–‡ä»¶ï¼ˆå› ä¸ºè¾¹ç•Œæ¡†ä½ç½®æ²¡å˜ï¼‰ã€‚

åœ¨ Python ä¸­è¿è¡Œï¼š

```python
import shutil
from pathlib import Path

for split in ['train', 'val', 'test']:
    src = Path(f'../traffic_sign_data/low_light/labels/{split}')
    dst = Path(f'../traffic_sign_data/enhanced_images/{split}')
    dst.mkdir(parents=True, exist_ok=True)
    
    # åˆ›å»º labels å­ç›®å½•
    dst_labels = dst.parent / 'labels' / split
    dst_labels.mkdir(parents=True, exist_ok=True)
    
    # å¤åˆ¶æ‰€æœ‰ txt æ–‡ä»¶
    for txt_file in src.glob('*.txt'):
        shutil.copy(txt_file, dst_labels / txt_file.name)

print("æ ‡æ³¨æ–‡ä»¶å¤åˆ¶å®Œæˆï¼")
```

---

## ç¬¬ä¸ƒæ­¥ï¼šè®­ç»ƒæ¨¡å‹

### 7.1 æ£€æŸ¥é…ç½®æ–‡ä»¶

æ‰“å¼€ `d:\rgznzuoye\traffic_signs.yaml`ï¼Œç¡®è®¤è·¯å¾„æ­£ç¡®ï¼š

```yaml
# å¢å¼ºåå›¾åƒè·¯å¾„
train: traffic_sign_data/enhanced_images/train
val: traffic_sign_data/enhanced_images/val
test: traffic_sign_data/enhanced_images/test

# ç±»åˆ«æ•°é‡
nc: 43

# ç±»åˆ«åç§°
names: ["speed_20", "speed_30", ...]
```

**æ³¨æ„ï¼šè·¯å¾„æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œç›¸å¯¹äº yaml æ–‡ä»¶çš„ä½ç½®ã€‚**

### 7.2 åˆ›å»ºè®­ç»ƒè„šæœ¬

åˆ›å»º `train.py`ï¼š

```python
from enlightened_gtsrb import GTSRBEnlightenGANDetector

# åˆ›å»ºæ£€æµ‹å™¨
detector = GTSRBEnlightenGANDetector(config_path='../traffic_signs.yaml')

# åŠ è½½ YOLOv8 æ¨¡å‹
print("åŠ è½½ YOLOv8 æ¨¡å‹...")
detector.setup_yolov8('yolov8n.pt')  # nano ç‰ˆæœ¬ï¼Œé€Ÿåº¦å¿«

# å¼€å§‹è®­ç»ƒ
print("å¼€å§‹è®­ç»ƒ...")
detector.train_yolov8(
    epochs=50,       # è®­ç»ƒ 50 è½®ï¼ˆå¯ä»¥å…ˆå°‘è®­ç»ƒå‡ è½®è¯•è¯•ï¼‰
    imgsz=640,       # å›¾åƒå¤§å°
    batch=16,        # æ‰¹æ¬¡å¤§å°ï¼ˆå¦‚æœå†…å­˜ä¸å¤Ÿï¼Œæ”¹æˆ 8 æˆ– 4ï¼‰
    device='0'       # ä½¿ç”¨ GPU 0ï¼Œå¦‚æœæ²¡æœ‰ GPU æ”¹æˆ 'cpu'
)

print("è®­ç»ƒå®Œæˆï¼")
```

### 7.3 è¿è¡Œè®­ç»ƒ

```bash
python train.py
```

**è®­ç»ƒä¼šèŠ±å¾ˆé•¿æ—¶é—´**ï¼ˆå‡ ä¸ªå°æ—¶åˆ°ä¸€å¤©ä¸ç­‰ï¼Œå–å†³äºä½ çš„ç¡¬ä»¶ï¼‰ã€‚

### 7.4 è§‚å¯Ÿè®­ç»ƒè¿‡ç¨‹

è®­ç»ƒæ—¶ä¼šæ˜¾ç¤ºï¼š
- **Loss**ï¼šæŸå¤±å€¼ï¼Œè¶Šå°è¶Šå¥½
- **mAP**ï¼šå¹³å‡ç²¾åº¦ï¼Œè¶Šå¤§è¶Šå¥½
- **Precision**ï¼šç²¾ç¡®ç‡
- **Recall**ï¼šå¬å›ç‡

è®­ç»ƒç»“æœä¼šä¿å­˜åœ¨ `runs/train/gtsrb_enlightengan/`

---

## ç¬¬å…«æ­¥ï¼šæµ‹è¯•å’Œè¯„ä¼°

### 8.1 åœ¨éªŒè¯é›†ä¸Šè¯„ä¼°

åˆ›å»º `evaluate.py`ï¼š

```python
from enlightened_gtsrb import GTSRBEnlightenGANDetector

# åˆ›å»ºæ£€æµ‹å™¨
detector = GTSRBEnlightenGANDetector(config_path='../traffic_signs.yaml')

# åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹
best_model = 'runs/train/gtsrb_enlightengan/weights/best.pt'
detector.setup_yolov8(best_model)

# åœ¨éªŒè¯é›†ä¸Šè¯„ä¼°
print("åœ¨éªŒè¯é›†ä¸Šè¯„ä¼°...")
val_results = detector.validate(split='val')

# åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°
print("åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°...")
test_results = detector.validate(split='test')

print("è¯„ä¼°å®Œæˆï¼")
```

### 8.2 æµ‹è¯•å•å¼ å›¾ç‰‡

åˆ›å»º `test_single.py`ï¼š

```python
from enlightened_gtsrb import GTSRBEnlightenGANDetector

# åˆ›å»ºæ£€æµ‹å™¨
detector = GTSRBEnlightenGANDetector(config_path='../traffic_signs.yaml')

# åŠ è½½æ¨¡å‹
detector.setup_yolov8('runs/train/gtsrb_enlightengan/weights/best.pt')

# é¢„æµ‹
test_image = '../traffic_sign_data/enhanced_images/test/test_000001.png'
results = detector.predict(test_image, conf=0.5)

# å¯è§†åŒ–
detector.visualize_results(test_image, results)
```

---

## å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ

### é”™è¯¯ 1: `ModuleNotFoundError: No module named 'ultralytics'`

**åŸå› **ï¼šæ²¡æœ‰å®‰è£…ä¾èµ–åŒ…

**è§£å†³**ï¼š
```bash
pip install -r requirements.txt
```

### é”™è¯¯ 2: `FileNotFoundError: [Errno 2] No such file or directory`

**åŸå› **ï¼šè·¯å¾„ä¸å¯¹

**è§£å†³**ï¼š
1. æ£€æŸ¥è·¯å¾„æ˜¯å¦å­˜åœ¨
2. ä½¿ç”¨ç»å¯¹è·¯å¾„ä»£æ›¿ç›¸å¯¹è·¯å¾„
3. ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„æ–œæ ï¼ˆWindows ç”¨ `\` æˆ– `/`ï¼ŒLinux/Mac ç”¨ `/`ï¼‰

### é”™è¯¯ 3: `CUDA out of memory`

**åŸå› **ï¼šGPU å†…å­˜ä¸è¶³

**è§£å†³**ï¼š
1. å‡å° batch sizeï¼ˆä¾‹å¦‚ä» 16 æ”¹ä¸º 8 æˆ– 4ï¼‰
2. å‡å°å›¾åƒå¤§å°ï¼ˆä¾‹å¦‚ä» 640 æ”¹ä¸º 512ï¼‰
3. ä½¿ç”¨æ›´å°çš„æ¨¡å‹ï¼ˆä¾‹å¦‚ä» yolov8m æ”¹ä¸º yolov8nï¼‰

### é”™è¯¯ 4: è®­ç»ƒå¾ˆæ…¢

**å¯èƒ½åŸå› **ï¼š
1. ä½¿ç”¨äº† CPU è€Œä¸æ˜¯ GPU
2. æ•°æ®åŠ è½½æ…¢ï¼ˆç¡¬ç›˜é€Ÿåº¦æ…¢ï¼‰

**è§£å†³**ï¼š
1. ç¡®è®¤ä½¿ç”¨äº† GPUï¼š`device='0'`
2. å‡å° batch size
3. ä½¿ç”¨ SSD è€Œä¸æ˜¯ HDD

### é”™è¯¯ 5: ç²¾åº¦å¾ˆä½

**å¯èƒ½åŸå› **ï¼š
1. è®­ç»ƒè½®æ•°å¤ªå°‘
2. å­¦ä¹ ç‡ä¸åˆé€‚
3. æ•°æ®è´¨é‡é—®é¢˜

**è§£å†³**ï¼š
1. å¢åŠ è®­ç»ƒè½®æ•°ï¼ˆä¾‹å¦‚æ”¹ä¸º 100 æˆ– 200ï¼‰
2. æ£€æŸ¥æ•°æ®æ ‡æ³¨æ˜¯å¦æ­£ç¡®
3. å°è¯•ä¸åŒçš„æ¨¡å‹å¤§å°

---

## ğŸ‰ æ­å–œï¼

å¦‚æœä½ å®Œæˆäº†æ‰€æœ‰æ­¥éª¤ï¼Œä½ å°±æˆåŠŸå®ç°äº†ä¸€ä¸ªä½å…‰ç…§äº¤é€šæ ‡å¿—æ£€æµ‹ç³»ç»Ÿï¼

**ä¸‹ä¸€æ­¥å¯ä»¥åšä»€ä¹ˆï¼Ÿ**
1. å°è¯•ä½¿ç”¨çœŸæ­£çš„ EnlightenGAN æ¨¡å‹
2. åœ¨è‡ªå·±æ‹æ‘„çš„å›¾ç‰‡ä¸Šæµ‹è¯•
3. å°è¯•ä¸åŒçš„ YOLOv8 æ¨¡å‹å¤§å°
4. è°ƒæ•´è®­ç»ƒå‚æ•°ä»¥è·å¾—æ›´å¥½çš„æ•ˆæœ

**æœ‰é—®é¢˜ï¼Ÿ**
- é‡æ–°é˜…è¯»è¿™ä»½æ•™ç¨‹
- æ£€æŸ¥é”™è¯¯ä¿¡æ¯
- åœ¨ç½‘ä¸Šæœç´¢é”™è¯¯ä¿¡æ¯
- å‘è€å¸ˆæˆ–åŒå­¦æ±‚åŠ©

ç¥ä½ æˆåŠŸï¼ğŸš€

